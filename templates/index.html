<!DOCTYPE html>
<html>
<head>
<title>THKBot168 Dashboard</title>
<link rel="icon" type="image/png" href="{{ url_for('static', filename='icons8-lion-head-64.png') }}">
<style>
.header-logos img:first-child {
  height: 216px;
}
/* ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö */
/* ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö (‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà 3 ‡πÄ‡∏ó‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á) */
.header-logos {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 48px;
  margin-bottom: 16px;
  margin-top: 16px;
}
.header-logos img {
  height: 144px;
  width: auto;
  object-fit: contain;
  background: transparent !important;
  border-radius: 12px;
  box-shadow: none;
}
.header-logos .sk-logo {
  height: 108px;
  background: transparent !important;
}
/* ‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ */
.account-settings-btn {
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 8px 18px;
  font-size: 1em;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  transition: background 0.2s;
  margin-left: 10px;
}
.account-settings-btn:hover {
  background: #0056b3;
}
body{font-family:'Segoe UI',sans-serif;background:#f0f2f5;margin:0;padding:20px;color:#333;transition:all 0.3s}
body.night{background:#121212;color:#eee}
body.night table{border-color:#444}
body.night th{background:#1e1e1e;color:#fff}
body.night tr{background-color:transparent;transition:none;} 
body.night tr:hover{background-color:#2a2a2a;transition:background-color 0.3s;}
body.night .summary-card{background:#1e1e1e;color:#eee;box-shadow:0 4px 12px rgba(0,0,0,0.5)}
body.night td{background-color:#1e1e1e;color:#eee;transition:background-color 0.3s;}
h1{text-align:center;margin-bottom:20px}
h2{margin:10px 0}
/* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á summary-card */
#top-bar{
  display:flex;
  justify-content:flex-start;
  align-items:flex-start;
  flex-wrap:wrap;
  margin-bottom:20px;
  gap:10px;
  position:relative;
}
.summary-card{
  background:#fff;
  border-radius:12px;
  padding:15px 24px 15px 24px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  min-width:0;
  width:auto;
  max-width:420px;
  display:flex;
  flex-direction:column;
  align-items:center;
  transition:all 0.3s;
}
.summary-card h2{font-size:1.2em;text-align:center;margin-bottom:10px;}
.summary-card span#wallet-info{
    display:block;
    font-size:2em;
    font-weight:bold;
    color:#28a745;
    text-align:center;
    margin-top:10px;
}
.summary-card span#wallet-info::after{
    content: " ‡∏ö‡∏≤‡∏ó";
    font-size:1em;
    color:#333;
}
body.night .summary-card span#wallet-info::after{
    color:#eee;
}
#dashboard{display:flex;gap:20px;flex-wrap:wrap}
#left-column,#right-column{flex:1;min-width:300px;display:flex;flex-direction:column;gap:20px}
#bottom-row{margin-top:20px}
.scroll-box{max-height:400px;overflow-y:auto;background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);padding:10px;scroll-behavior:smooth;transition:all 0.3s}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;text-align:center;font-size:0.95em;border-bottom:1px solid #ddd;}
thead th {white-space:nowrap;word-break:normal;max-width:none;}
tbody td {word-break:break-all;max-width:180px;overflow:hidden;text-overflow:ellipsis;}
th{position:sticky;top:0;background:#f8f9fa;z-index:2}
tr:hover{background-color:#f1f5f9;transition:0.3s}
button{padding:5px 10px;border:none;border-radius:6px;cursor:pointer;transition:0.3s;margin:2px}
button.approve{background:#28a745;color:white}
button.approve:hover{background:#218838}
button.cancel{background:#dc3545;color:white}
button.restore{background:#ffc107;color:#333}
button.restore:hover{background:#e0a800}
button.delete-slip{background:#dc3545;color:white;margin-left:5px}
#toggle-mode{position:absolute;top:10px;right:20px;cursor:pointer;font-size:1.5em;}
input.customer-user{width:100%;padding:3px;border-radius:4px;border:1px solid #ccc;box-sizing:border-box}
.paste-area{margin-top:5px;padding:5px;border:1px dashed #ccc;border-radius:4px;min-height:40px;text-align:center;color:#999;font-size:0.85em;}
.paste-area:hover{border-color:#28a745;color:#28a745;}
::-webkit-scrollbar{width:8px}
::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,0.2);border-radius:4px}
::-webkit-scrollbar-track{background:transparent}
</style>
</head>
<body>
<!-- ‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö (2 ‡πÇ‡∏•‡πÇ‡∏Å‡πâ, ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°, ‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏•‡∏≤‡∏á, ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á 5 ‡∏ô‡∏≤‡∏ó‡∏µ) -->
<div class="header-logos" id="header-logos">
  <img src="{{ url_for('static', filename='5e9e7571-ef8d-4e7c-9e51-6b50221aceec.png') }}" alt="Logo1" style="height:80px;max-width:160px;width:auto;object-fit:contain;margin:0 16px;">
  <img src="{{ url_for('static', filename='ngox-header.png.png') }}" alt="NGOX Logo" style="height:80px;max-width:160px;width:auto;object-fit:contain;margin:0 16px;">
</div>
<h1>Dashboard(Realtime)</h1>

<div id="top-bar">
  <div class="summary-card" style="position:relative;">
    <div style="position:absolute;top:10px;left:10px;display:flex;align-items:center;gap:6px;">
      <span id="tw-tk-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
      <span id="tw-tk-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
    </div>
    <h2 style="margin-top:32px;">üí∞ Truewallet TK</h2>
    <span id="tw-balance" style="display:block;font-size:2em;font-weight:bold;color:#28a745;text-align:center;margin-top:10px;">-</span>
    <div id="tw-info" style="font-size:1em;color:#555;text-align:center;margin-top:4px;">
      <span id="tw-mobile">-</span><br>
      <span id="tw-updated">-</span>
    </div>
    <div style="margin-top:10px;text-align:center;">
      <button onclick="resetApproved()">‡∏£‡∏µ‡πÄ‡∏ã‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
      <button onclick="resetCancelled()">‡∏£‡∏µ‡πÄ‡∏ã‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    </div>
  </div>
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡πÑ‡∏°‡πà‡πÄ‡∏≠‡∏≤‡∏õ‡∏∏‡πà‡∏°) -->
  <div class="summary-card" id="account-balance-box" style="max-width:320px;min-width:180px;position:relative;">
    <div style="position:absolute;top:10px;left:10px;display:flex;align-items:center;gap:6px;">
      <span id="scb-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
      <span id="scb-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
    </div>
    <h2 style="font-size:1.1em;margin-bottom:8px;">SCB ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå ‡∏Ñ‡∏¥‡∏°‡∏†‡∏¥‡∏£‡∏≤‡∏ô‡∏ô‡∏ó‡πå</h2>
    <div style="font-size:1.5em;font-weight:bold;color:#8000ff;display:flex;align-items:center;justify-content:center;gap:8px;">
      SCB
      <span id="scb-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
    </div>
  <span id="account-balance-info" style="display:block;font-size:2em;font-weight:bold;color:#ff9800;text-align:center;margin-top:10px;">0 ‡∏ö‡∏≤‡∏ó</span>
    <div style="font-size:0.95em;color:#888;text-align:center;margin-top:2px;">‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
  </div>
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (SCB ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏ô‡∏≤‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£) -->
  <div class="summary-card" id="account-balance-box2" style="max-width:320px;min-width:180px;position:relative;">
    <div style="position:absolute;top:10px;left:10px;display:flex;align-items:center;gap:6px;">
      <span id="scb2-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
      <span id="scb2-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
    </div>
    <h2 style="font-size:1.1em;margin-bottom:8px;">SCB ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏ô‡∏≤‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£</h2>
    <div style="font-size:1.5em;font-weight:bold;color:#8000ff;display:flex;align-items:center;justify-content:center;gap:8px;">
      SCB
      <span id="scb2-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
    </div>
  <span id="account-balance-info2" style="display:block;font-size:2em;font-weight:bold;color:#ff9800;text-align:center;margin-top:10px;">0 ‡∏ö‡∏≤‡∏ó</span>
    <div style="font-size:0.95em;color:#888;text-align:center;margin-top:2px;">‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
  </div>
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á Truewallet BB ENJ -->
  <div class="summary-card" id="tw-bb-box" style="max-width:420px;min-width:180px;position:relative;">
    <div style="position:absolute;top:10px;left:10px;display:flex;align-items:center;gap:6px;">
      <span id="tw-bb-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
      <span id="tw-bb-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
    </div>
    <h2>ü™ô Truewallet BB ENJ</h2>
    <span id="tw-bb-balance" style="display:block;font-size:2em;font-weight:bold;color:#28a745;text-align:center;margin-top:10px;">-</span>
    <div id="tw-bb-info" style="font-size:1em;color:#555;text-align:center;margin-top:4px;">
        <div style="position:absolute;top:10px;right:10px;display:flex;align-items:center;gap:6px;">
          <span id="tw-bb-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
          <span id="tw-bb-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
        </div>
      <span id="tw-bb-mobile">-</span><br>
      <span id="tw-bb-updated">-</span>
    </div>
  </div>
  <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á Truewallet BP -->
  <div class="summary-card" id="tw-bp-box" style="max-width:420px;min-width:180px;position:relative;">
    <div style="position:absolute;top:10px;left:10px;display:flex;align-items:center;gap:6px;">
      <span id="tw-bp-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
      <span id="tw-bp-status-text" style="font-size:0.95em;color:#555;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: -</span>
    </div>
    <h2>üßß Truewallet BP</h2>
    <span id="tw-bp-balance" style="display:block;font-size:2em;font-weight:bold;color:#28a745;text-align:center;margin-top:10px;">-</span>
    <div id="tw-bp-info" style="font-size:1em;color:#555;text-align:center;margin-top:4px;">
      <span id="tw-bp-mobile">-</span><br>
      <span id="tw-bp-updated">-</span>
    </div>
  </div>
  <div style="display:flex;align-items:center;gap:10px;">
    <button class="account-settings-btn" onclick="window.location.href='/account_settings'">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
    <div id="toggle-mode">üåû</div>
  </div>
</div>

<div id="dashboard">
  <!-- ‡∏•‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á New Orders ‡∏≠‡∏≠‡∏Å -->
  <!--
  <div id="left-column">
  <h2><img src="{{ url_for('static', filename='logo wallet.png') }}" alt="Wallet Logo" style="height:32px;max-width:80px;width:auto;vertical-align:middle;margin-right:8px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà (New Orders)</h2>
    <div class="scroll-box">
      <table id="new-orders-table">
        <thead>
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th>‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå</th><th>‡∏¢‡∏π‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th><th>‡∏™‡∏•‡∏¥‡∏õ</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  -->
  <!-- Section ‡πÉ‡∏´‡∏°‡πà: ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ù‡∏≤‡∏Å‡∏ß‡∏≠‡πÄ‡∏•‡∏ó -->
  <div id="wallet-deposit-section">
  <h2><img src="{{ url_for('static', filename='logo wallet.png') }}" alt="Wallet Logo" style="height:32px;max-width:80px;width:auto;vertical-align:middle;margin-right:8px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ù‡∏≤‡∏Å‡∏ß‡∏≠‡πÄ‡∏•‡∏ó (Wallet Deposits)</h2>
    <div class="scroll-box">
      <table id="wallet-deposit-table">
        <thead>
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th>‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå</th><th>‡∏¢‡∏π‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th><th>‡∏™‡∏•‡∏¥‡∏õ</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
  <!-- /Section ‡πÉ‡∏´‡∏°‡πà -->
  <div id="right-column">
  <h2><img src="{{ url_for('static', filename='logo wallet.png') }}" alt="Wallet Logo" style="height:32px;max-width:80px;width:auto;vertical-align:middle;margin-right:8px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß (Approved Orders)</h2>
    <div class="scroll-box">
      <table id="approved-orders-table">
        <thead>
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th>‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th><th>‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th><th>‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th><th>‡∏¢‡∏π‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th><th>‡∏™‡∏•‡∏¥‡∏õ</th><th>‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô New</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

  <h2><img src="{{ url_for('static', filename='logo wallet.png') }}" alt="Wallet Logo" style="height:32px;max-width:80px;width:auto;vertical-align:middle;margin-right:8px;">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÅ‡∏•‡πâ‡∏ß (Cancelled Orders)</h2>
    <div class="scroll-box">
      <table id="cancelled-orders-table">
        <thead>
        <tr><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th>‡∏ä‡∏∑‡πà‡∏≠/‡πÄ‡∏ö‡∏≠‡∏£‡πå</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</th><th>‡∏ú‡∏π‡πâ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</th><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏¢‡∏π‡∏™‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</th><th>‡∏™‡∏•‡∏¥‡∏õ</th><th>‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô New</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<div id="bottom-row">


  <div style="display: flex; gap: 20px; align-items: flex-start;">
    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ã‡πâ‡∏≤‡∏¢: ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå ‡∏Ñ‡∏¥‡∏°‡∏†‡∏¥‡∏£‡∏≤‡∏ô‡∏ô‡∏ó‡πå -->
    <div class="scb-account-box" style="flex:1; background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); padding:16px; margin-bottom:10px;">
      <div style="display:flex;align-items:center;gap:10px; margin-bottom:8px;">
      <img src="{{ url_for('static', filename='scb-logo.png') }}" alt="SCB Logo" style="height:32px;max-width:80px;width:auto;">
        <span id="scb-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
        <span id="scb-status-text">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
      </div>
      <div style="margin-bottom:8px;">
  <span style="font-weight:bold;">SCB ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå ‡∏Ñ‡∏¥‡∏°‡∏†‡∏¥‡∏£‡∏≤‡∏ô‡∏ô‡∏ó‡πå</span>
      </div>
      <div class="scroll-box" style="width: 100%; max-height: 220px; overflow-y: auto; border:none">
        <table id="scb-sms-table" style="width:100%;border:none">
          <thead>
            <tr>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              <th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡∏ß‡∏≤: ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏ô‡∏≤‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£ -->
    <div class="scb-account-box" style="flex:1; background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); padding:16px; margin-bottom:10px;">
      <div style="display:flex;align-items:center;gap:10px; margin-bottom:8px;">
      <img src="{{ url_for('static', filename='scb-logo.png') }}" alt="SCB Logo" style="height:32px;max-width:80px;width:auto;">
        <span id="scb2-status-light" style="display:inline-block;width:16px;height:16px;border-radius:50%;background:#ccc;border:2px solid #888;"></span>
        <span id="scb2-status-text">‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...</span>
      </div>
      <div style="margin-bottom:8px;">
  <span style="font-weight:bold;">SCB ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏ô‡∏≤‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£ </span>
      </div>
      <div class="scroll-box" style="width: 100%; max-height: 220px; overflow-y: auto; border:none">
        <table id="scb2-sms-table" style="width:100%;border:none">
          <thead>
            <tr>
              <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏ß‡∏•‡∏≤</th>
              <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
              <th>‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (5 ‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)</h2>
  <div class="scroll-box" style="max-height:180px;overflow-y:auto;">
    <table id="daily-summary" style="width:100%;border:none">
      <thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th>‡∏£‡∏ß‡∏°‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

</div>



<script>
// --- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏ü‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Å‡∏•‡πà‡∏≠‡∏á summary-card ---
async function updateStatusLights() {
  // Truewallet TK
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: { 'Authorization': 'Bearer dce99fdf74189d0854c0eeb627c1f4d8' }
    });
    if (resp.ok) {
      document.getElementById('tw-tk-status-light').style.background = '#28a745';
      document.getElementById('tw-tk-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      document.getElementById('tw-tk-status-light').style.background = '#dc3545';
      document.getElementById('tw-tk-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
  } catch (e) {
    document.getElementById('tw-tk-status-light').style.background = '#dc3545';
    document.getElementById('tw-tk-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
  }
  // SCB ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå
  try {
    const resp = await fetch(`/api/sms?tag=sumitkimphiranon&sender=027777777`);
    if (resp.ok) {
      document.getElementById('scb-status-light').style.background = '#28a745';
      document.getElementById('scb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      document.getElementById('scb-status-light').style.background = '#dc3545';
      document.getElementById('scb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
  } catch (e) {
    document.getElementById('scb-status-light').style.background = '#dc3545';
    document.getElementById('scb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
  }
  // SCB ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô
  try {
    const resp = await fetch(`/api/sms?tag=ploypairinnamkhot&sender=027777777`);
    if (resp.ok) {
      document.getElementById('scb2-status-light').style.background = '#28a745';
      document.getElementById('scb2-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      document.getElementById('scb2-status-light').style.background = '#dc3545';
      document.getElementById('scb2-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
  } catch (e) {
    document.getElementById('scb2-status-light').style.background = '#dc3545';
    document.getElementById('scb2-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
  }
  // Truewallet BB ENJ
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: { 'Authorization': 'Bearer 4cb88e53852339a9257c6fa1dccdb6af' }
    });
    if (resp.ok) {
      document.getElementById('tw-bb-status-light').style.background = '#28a745';
      document.getElementById('tw-bb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      document.getElementById('tw-bb-status-light').style.background = '#dc3545';
      document.getElementById('tw-bb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
  } catch (e) {
    document.getElementById('tw-bb-status-light').style.background = '#dc3545';
    document.getElementById('tw-bb-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
  }
  // Truewallet BP
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: { 'Authorization': 'Bearer 2ecade3f36166b2b9858e281e95c8560' }
    });
    if (resp.ok) {
      document.getElementById('tw-bp-status-light').style.background = '#28a745';
      document.getElementById('tw-bp-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      document.getElementById('tw-bp-status-light').style.background = '#dc3545';
      document.getElementById('tw-bp-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
  } catch (e) {
    document.getElementById('tw-bp-status-light').style.background = '#dc3545';
    document.getElementById('tw-bp-status-text').innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
  }
}
setInterval(updateStatusLights, 3000);
window.addEventListener('DOMContentLoaded', updateStatusLights);
// --- ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î Truewallet BP ‡∏ú‡πà‡∏≤‡∏ô API ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---
async function fetchTruewalletBPBalance() {
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer 2ecade3f36166b2b9858e281e95c8560'
      }
    });
    if (!resp.ok) throw new Error('API Error');
    const data = await resp.json();
    if (data.status === 'ok' && data.data) {
      let balance = data.data.balance ? (parseInt(data.data.balance, 10) / 100).toLocaleString('en-US', {minimumFractionDigits:2}) : '-';
      document.getElementById('tw-bp-balance').innerText = balance + ' ‡∏ö‡∏≤‡∏ó';
      document.getElementById('tw-bp-mobile').innerText = '‡πÄ‡∏ö‡∏≠‡∏£‡πå: ' + (data.data.mobile_no || '-');
      document.getElementById('tw-bp-updated').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ' + (data.data.updated_at || '-');
    } else {
      document.getElementById('tw-bp-balance').innerText = '-';
      document.getElementById('tw-bp-mobile').innerText = '-';
      document.getElementById('tw-bp-updated').innerText = '-';
    }
  } catch (e) {
    document.getElementById('tw-bp-balance').innerText = '-';
    document.getElementById('tw-bp-mobile').innerText = '-';
    document.getElementById('tw-bp-updated').innerText = '-';
  }
}
setInterval(fetchTruewalletBPBalance, 10000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
fetchTruewalletBPBalance();
// --- ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î Truewallet BB ENJ ‡∏ú‡πà‡∏≤‡∏ô API ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---
async function fetchTruewalletBBBalance() {
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer 4cb88e53852339a9257c6fa1dccdb6af'
      }
    });
    if (!resp.ok) throw new Error('API Error');
    const data = await resp.json();
    if (data.status === 'ok' && data.data) {
      let balance = data.data.balance ? (parseInt(data.data.balance, 10) / 100).toLocaleString('en-US', {minimumFractionDigits:2}) : '-';
      document.getElementById('tw-bb-balance').innerText = balance + ' ‡∏ö‡∏≤‡∏ó';
      document.getElementById('tw-bb-mobile').innerText = '‡πÄ‡∏ö‡∏≠‡∏£‡πå: ' + (data.data.mobile_no || '-');
      document.getElementById('tw-bb-updated').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ' + (data.data.updated_at || '-');
    } else {
      document.getElementById('tw-bb-balance').innerText = '-';
      document.getElementById('tw-bb-mobile').innerText = '-';
      document.getElementById('tw-bb-updated').innerText = '-';
    }
  } catch (e) {
    document.getElementById('tw-bb-balance').innerText = '-';
    document.getElementById('tw-bb-mobile').innerText = '-';
    document.getElementById('tw-bb-updated').innerText = '-';
  }
}
setInterval(fetchTruewalletBBBalance, 10000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
fetchTruewalletBBBalance();
// --- ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î TrueMoney Wallet ‡∏ú‡πà‡∏≤‡∏ô API ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---
async function fetchTruewalletBalance() {
  try {
    const resp = await fetch('https://apis.truemoneyservices.com/account/v1/balance', {
      method: 'GET',
      headers: {
        'Authorization': 'Bearer dce99fdf74189d0854c0eeb627c1f4d8'
      }
    });
    if (!resp.ok) throw new Error('API Error');
    const data = await resp.json();
    if (data.status === 'ok' && data.data) {
      // ‡πÅ‡∏õ‡∏•‡∏á‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏≤‡∏ó
      let balance = data.data.balance ? (parseInt(data.data.balance, 10) / 100).toLocaleString('en-US', {minimumFractionDigits:2}) : '-';
      document.getElementById('tw-balance').innerText = balance + ' ‡∏ö‡∏≤‡∏ó';
      document.getElementById('tw-mobile').innerText = '‡πÄ‡∏ö‡∏≠‡∏£‡πå: ' + (data.data.mobile_no || '-');
      document.getElementById('tw-updated').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ' + (data.data.updated_at || '-');
    } else {
      document.getElementById('tw-balance').innerText = '-';
      document.getElementById('tw-mobile').innerText = '-';
      document.getElementById('tw-updated').innerText = '-';
    }
  } catch (e) {
    document.getElementById('tw-balance').innerText = '-';
    document.getElementById('tw-mobile').innerText = '-';
    document.getElementById('tw-updated').innerText = '-';
  }
}
setInterval(fetchTruewalletBalance, 10000); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏∏‡∏Å 10 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
fetchTruewalletBalance();
// --- ‡∏ã‡πà‡∏≠‡∏ô‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏´‡∏±‡∏ß‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö 5 ‡∏ô‡∏≤‡∏ó‡∏µ ---
window.addEventListener('DOMContentLoaded', function() {
  setTimeout(function() {
    var logos = document.getElementById('header-logos');
    if (logos) logos.style.display = 'none';
  }, 300000); // 5 ‡∏ô‡∏≤‡∏ó‡∏µ = 300,000 ms
});
// --- ‡∏î‡∏∂‡∏á‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ SCB ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå ‡∏Ñ‡∏¥‡∏°‡∏†‡∏¥‡∏£‡∏≤‡∏ô‡∏ô‡∏ó‡πå ‡πÅ‡∏•‡∏∞ ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô ‡∏ô‡∏≤‡∏°‡πÇ‡∏Ñ‡∏ï‡∏£ ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ---
async function updateAccountBalanceBox() {
  try {
    const resp = await fetch(`/api/sms?tag=sumitkimphiranon&sender=027777777`);
    const data = await resp.json();
    let smsList = Array.isArray(data) ? data : (data.sms_list || []);
    let latest = smsList.length > 0 ? smsList[smsList.length-1] : null;
    let balance = latest && latest.balance ? latest.balance.replace(/[^\d.,]/g, '') : '0';
    document.getElementById('account-balance-info').innerText = balance + ' ‡∏ö‡∏≤‡∏ó';
    // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
    document.getElementById('scb-status-light').style.background = latest ? 'lime' : '#ccc';
  } catch (e) {
    document.getElementById('account-balance-info').innerText = '0';
    // ‡∏ñ‡πâ‡∏≤ error ‡πÉ‡∏´‡πâ‡πÑ‡∏ü‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á
    document.getElementById('scb-status-light').style.background = 'red';
  }
  try {
    const resp2 = await fetch(`/api/sms?tag=ploypairinnamkhot&sender=027777777`);
    const data2 = await resp2.json();
    let smsList2 = Array.isArray(data2) ? data2 : (data2.sms_list || []);
    let latest2 = smsList2.length > 0 ? smsList2[smsList2.length-1] : null;
    let balance2 = latest2 && latest2.balance ? latest2.balance.replace(/[^\d.,]/g, '') : '0';
    document.getElementById('account-balance-info2').innerText = balance2 + ' ‡∏ö‡∏≤‡∏ó';
    document.getElementById('scb2-status-light').style.background = latest2 ? 'lime' : '#ccc';
  } catch (e) {
    document.getElementById('account-balance-info2').innerText = '0';
    document.getElementById('scb2-status-light').style.background = 'red';
  }
}
setInterval(updateAccountBalanceBox, 3000);
updateAccountBalanceBox();
// --- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô ---
document.addEventListener('DOMContentLoaded', function() {
  const toggleModeBtn = document.getElementById('toggle-mode');
  toggleModeBtn.addEventListener('click', function() {
    document.body.classList.toggle('night');
    if(document.body.classList.contains('night')) {
      toggleModeBtn.textContent = 'üåô';
    } else {
      toggleModeBtn.textContent = 'üåû';
    }
  });
});
// --- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SCB ‡∏™‡∏∏‡∏°‡∏¥‡∏ò‡∏£‡πå ‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏Å‡∏•‡πà‡∏≠‡∏á SCB ‡∏û‡∏•‡∏≠‡∏¢‡πÑ‡∏û‡∏£‡∏¥‡∏ô (copy data) ---
async function fetchScbSummaryBox() {
  try {
  const resp = await fetch(`/api/sms?tag=sumitkimphiranon&sender=027777777`);
    const data = await resp.json();
    let smsList = Array.isArray(data) ? data : (data.sms_list || []);
    if (smsList.length > 5) smsList = smsList.slice(-5);
    smsList = smsList.reverse();
    const tbody = document.querySelector('#scb-summary-table tbody');
    tbody.innerHTML = '';
    smsList.forEach(sms => {
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${sms.date_time || '-'}</td><td>${sms.detail || '-'}</td><td>${sms.balance || '-'}</td>`;
      tbody.appendChild(tr);
    });
  } catch (e) {
    const tbody = document.querySelector('#scb-summary-table tbody');
    tbody.innerHTML = '<tr><td colspan="3">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SMS ‡πÑ‡∏î‡πâ</td></tr>';
  }
}
setInterval(fetchScbSummaryBox, 3000);
fetchScbSummaryBox();

// --- ‡∏î‡∏∂‡∏á SMS ‡∏à‡∏≤‡∏Å API ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡∏∞ tag ‡πÑ‡∏î‡πâ ---



async function fetchScbSms(tableId, statusLightId, statusTextId, tag) {
  const statusLight = document.getElementById(statusLightId);
  const statusText = document.getElementById(statusTextId);
  try {
    const resp = await fetch(`/api/sms?tag=${tag}&sender=027777777`);
    if (resp.ok) {
      statusLight.style.background = '#28a745';
      statusText.innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à';
    } else {
      statusLight.style.background = '#dc3545';
      statusText.innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    }
    const data = await resp.json();
    let smsList = Array.isArray(data) ? data : (data.sms_list || []);
    if (smsList.length > 5) smsList = smsList.slice(-5);
    smsList = smsList.reverse();
    const tbody = document.querySelector(`#${tableId} tbody`);
    tbody.innerHTML = '';
    let count = 0;
    smsList.forEach(sms => {
      if (count >= 5) return;
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${sms.date_time || '-'}</td><td>${sms.detail || '-'}</td><td>${sms.balance || '-'}</td>`;
      tbody.appendChild(tr);
      count++;
    });
  } catch (e) {
    statusLight.style.background = '#dc3545';
    statusText.innerText = '‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡∏±‡∏î‡∏Ç‡πâ‡∏≠‡∏á';
    const tbody = document.querySelector(`#${tableId} tbody`);
    tbody.innerHTML = '<tr><td colspan="3">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• SMS ‡πÑ‡∏î‡πâ</td></tr>';
  }
}









window.addEventListener('DOMContentLoaded', () => {
  fetchScbSms('scb-sms-table', 'scb-status-light', 'scb-status-text', 'sumitkimphiranon');
  fetchScbSms('scb2-sms-table', 'scb2-status-light', 'scb2-status-text', 'ploypairinnamkhot');
  fetchScbSummaryBox();
});

setInterval(() => {
  fetchScbSms('scb-sms-table', 'scb-status-light', 'scb-status-text', 'sumitkimphiranon');
  fetchScbSms('scb2-sms-table', 'scb2-status-light', 'scb2-status-text', 'ploypairinnamkhot');
  fetchScbSummaryBox();
}, 3000);

// ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ user ‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏¢
let tempUserData = {};

// ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ù‡∏≤‡∏Å‡∏ß‡∏≠‡πÄ‡∏•‡∏ó‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å backend proxy ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á wallet-deposit-table
async function fetchDepositWallets() {
  try {
    let resp = await fetch("/api/wallet_deposit_data");
    let data = await resp.json();
    let walletList = Array.isArray(data.new_orders) ? data.new_orders : [];
    let walletBody = document.querySelector("#wallet-deposit-table tbody");
    if (!walletBody) return;
    walletBody.innerHTML = "";
    walletList.forEach(tx => {
      let row = walletBody.insertRow();
      row.insertCell(0).innerText = tx.event;
      row.insertCell(1).innerText = tx.amount_str;
      row.insertCell(2).innerText = tx.name || "-";
      let userCell = row.insertCell(3);
      let inputUser = document.createElement("input");
      inputUser.className = "customer-user";
      inputUser.value = tempUserData[tx.id] || tx.customer_user || "";
      inputUser.oninput = () => { tempUserData[tx.id] = inputUser.value; };
      userCell.appendChild(inputUser);
      // Format time: '‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ ‡πÄ‡∏ß‡∏•‡∏≤' (remove +07:00 but keep timezone logic)
      let rawTime = tx.time_str || tx.time || "-";
      let displayTime = rawTime;
      if (rawTime && rawTime !== "-") {
        // Remove timezone part if present
        let t = rawTime.replace(/\+\d{2}:?\d{2}$/, "");
        // Try to parse and format as DD/MM/YYYY HH:mm:ss
        let d = new Date(t);
        if (!isNaN(d.getTime())) {
          let pad = n => n.toString().padStart(2, '0');
          displayTime = `${pad(d.getDate())}/${pad(d.getMonth()+1)}/${d.getFullYear()} ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
        } else {
          displayTime = t;
        }
      }
      row.insertCell(4).innerText = displayTime;
      row.insertCell(5).innerText = tx.bank || "-";
      row.insertCell(6).innerText = "-"; // ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏•‡∏¥‡∏õ
      let cell = row.insertCell(7);
      let btnApprove = document.createElement("button");
      btnApprove.className = "approve"; btnApprove.innerText = "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥";
      btnApprove.onclick = async () => {
        let customer_user = inputUser.value.trim();
        alert("(Demo) ‡∏Å‡∏î‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥: " + tx.id + (customer_user ? " | user: " + customer_user : ""));
        delete tempUserData[tx.id];
        fetchDepositWallets();
      };
      let btnCancel = document.createElement("button");
      btnCancel.className = "cancel"; btnCancel.innerText = "‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å";
      btnCancel.onclick = async () => {
        alert("(Demo) ‡∏Å‡∏î‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å: " + tx.id);
        delete tempUserData[tx.id];
        fetchDepositWallets();
      };
      cell.appendChild(btnApprove);
      cell.appendChild(btnCancel);
    });
  } catch (e) {
    let walletBody = document.querySelector("#wallet-deposit-table tbody");
    if (walletBody) walletBody.innerHTML = '<tr><td colspan="8">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ù‡∏≤‡∏Å‡∏ß‡∏≠‡πÄ‡∏•‡∏ó</td></tr>';
  }
}

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏•‡∏±‡∏á fetchTransactions() ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
setInterval(() => { fetchDepositWallets(); }, 3000);
window.addEventListener('DOMContentLoaded', () => { fetchDepositWallets(); });

async function fetchTransactions(){
  try {
    let resp = await fetch("https://xinonshow789-production.up.railway.app/truewallet/webhook", {
      method: "GET",
      headers: {
        "Authorization": "Bearer defbe102c9f4e9eaad1e16de7f8efe13"
      }
    });
    let data = await resp.json();

    // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î wallet_daily_total ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ
    if (data.wallet_daily_total !== undefined && document.getElementById("wallet-info")) {
      document.getElementById("wallet-info").innerText = data.wallet_daily_total;
    }

    // daily summary
    let dailyBody = document.querySelector("#daily-summary tbody");
    if (dailyBody && Array.isArray(data.daily_summary)) {
      dailyBody.innerHTML="";
      let last5 = data.daily_summary.slice(-5);
      last5.forEach(d=>{
        let row = dailyBody.insertRow();
        row.insertCell(0).innerText=d.date;
        row.insertCell(1).innerText=d.total;
      });
    }

    function renderSlip(tx){
      let fileInput = `<input type="file" onchange="uploadSlip(event,'${tx.id}')">`;
      let pasteArea = `<div class="paste-area" contenteditable="true" onpaste="handlePaste(event,'${tx.id}')">‡∏ß‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà (Ctrl+V)</div>`;
      let deleteBtn = tx.slip_filename ? `<button class="delete-slip" onclick="deleteSlip('${tx.id}')">‡∏•‡∏ö‡∏£‡∏π‡∏õ</button>` : "";
      if(tx.slip_filename){
        return `<a href="/slip/${tx.slip_filename}" target="_blank">‡∏î‡∏π‡∏£‡∏π‡∏õ</a>` + pasteArea + deleteBtn;
      } else {
        return fileInput + pasteArea;
      }
    }

    // New Orders
    let newBody = document.querySelector("#new-orders-table tbody");
    if (newBody && Array.isArray(data.new_orders)) {
      newBody.innerHTML="";
      data.new_orders.forEach(tx=>{
        let row=newBody.insertRow();
        row.insertCell(0).innerText=tx.event;
        row.insertCell(1).innerText=tx.amount_str;
        row.insertCell(2).innerText=tx.name||"-";

        let userCell = row.insertCell(3);
        let inputUser = document.createElement("input");
        inputUser.className="customer-user";
        inputUser.value=tempUserData[tx.id] || tx.customer_user || "";
        inputUser.oninput=()=>{ tempUserData[tx.id] = inputUser.value; };
        userCell.appendChild(inputUser);

        row.insertCell(4).innerText=tx.time_str||"-";
        row.insertCell(5).innerText=tx.bank||"-";
        row.insertCell(6).innerHTML=renderSlip(tx);

        let cell=row.insertCell(7);
        let btnApprove=document.createElement("button");
        btnApprove.className="approve"; btnApprove.innerText="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥";
        btnApprove.onclick=async ()=>{
          let customer_user = inputUser.value.trim();
          await fetch("/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:tx.id,customer_user})});
          delete tempUserData[tx.id];
          fetchTransactions();
        };
        let btnCancel=document.createElement("button");
        btnCancel.className="cancel"; btnCancel.innerText="‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å";
        btnCancel.onclick=async ()=>{
          await fetch("/cancel",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:tx.id})});
          delete tempUserData[tx.id];
          fetchTransactions();
        };
        cell.appendChild(btnApprove);
        cell.appendChild(btnCancel);
      });
    }

    // Approved Orders
    let approvedBody=document.querySelector("#approved-orders-table tbody");
    if (approvedBody && Array.isArray(data.approved_orders)) {
      approvedBody.innerHTML="";
      data.approved_orders.forEach(tx=>{
        let row=approvedBody.insertRow();
        row.insertCell(0).innerText=tx.event;
        row.insertCell(1).innerText=tx.amount_str;
        row.insertCell(2).innerText=tx.name||"-";
        row.insertCell(3).innerText=tx.time_str||"-";
        row.insertCell(4).innerText=tx.bank||"-";
        row.insertCell(5).innerText=tx.approver_name||"-";
        row.insertCell(6).innerText=tx.approved_time_str||"-";
        row.insertCell(7).innerText=tx.customer_user||"-";
        row.insertCell(8).innerHTML=tx.slip_filename?`<a href="/slip/${tx.slip_filename}" target="_blank">‡∏î‡∏π‡∏£‡∏π‡∏õ</a>`:"-";
        let restoreBtn=document.createElement("button");
        restoreBtn.className="restore"; restoreBtn.innerText="‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô New";
        restoreBtn.onclick=async ()=>{if(!confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô New?")) return;await fetch("/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:tx.id})});fetchTransactions();};
        row.insertCell(9).appendChild(restoreBtn);
      });
    }

    // Cancelled Orders
    let cancelledBody=document.querySelector("#cancelled-orders-table tbody");
    if (cancelledBody && Array.isArray(data.cancelled_orders)) {
      cancelledBody.innerHTML="";
      data.cancelled_orders.forEach(tx=>{
        let row=cancelledBody.insertRow();
        row.insertCell(0).innerText=tx.event;
        row.insertCell(1).innerText=tx.amount_str;
        row.insertCell(2).innerText=tx.name||"-";
        row.insertCell(3).innerText=tx.time_str||"-";
        row.insertCell(4).innerText=tx.bank||"-";
        row.insertCell(5).innerText=tx.canceler_name||"-";
        row.insertCell(6).innerText=tx.cancelled_time_str||"-";
        row.insertCell(7).innerText=tx.customer_user||"-";
        row.insertCell(8).innerHTML=tx.slip_filename?`<a href="/slip/${tx.slip_filename}" target="_blank">‡∏î‡∏π‡∏£‡∏π‡∏õ</a>`:"-";
        let restoreBtn=document.createElement("button");
        restoreBtn.className="restore"; restoreBtn.innerText="‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏õ‡πá‡∏ô New";
        restoreBtn.onclick=async ()=>{if(!confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô New?")) return;await fetch("/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:tx.id})});fetchTransactions();};
        row.insertCell(9).appendChild(restoreBtn);
      });
    }
  } catch (e) {
    // ‡∏Å‡∏£‡∏ì‡∏µ error ‡πÉ‡∏´‡πâ clear ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
    let newBody = document.querySelector("#new-orders-table tbody");
    let approvedBody = document.querySelector("#approved-orders-table tbody");
    let cancelledBody = document.querySelector("#cancelled-orders-table tbody");
    if (newBody) newBody.innerHTML = '<tr><td colspan="8">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
    if (approvedBody) approvedBody.innerHTML = '<tr><td colspan="10">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
    if (cancelledBody) cancelledBody.innerHTML = '<tr><td colspan="10">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
  }
}

async function uploadSlip(event, txid){
    const file = event.target.files[0];
    if(!file) return;
    const formData = new FormData();
    formData.append("file", file);
    await fetch(`/upload_slip/${txid}`, {method:"POST", body:formData});
    fetchTransactions();
}

function handlePaste(event, txid){
    const items = (event.clipboardData || event.originalEvent.clipboardData).items;
    for(let i=0;i<items.length;i++){
        const item = items[i];
        if(item.kind === 'file'){
            const blob = item.getAsFile();
            const formData = new FormData();
            formData.append("file", blob, `pasted_${Date.now()}.png`);
            fetch(`/upload_slip/${txid}`, {method:"POST", body:formData}).then(()=>fetchTransactions());
            event.preventDefault();
            break;
        }
    }
}

async function deleteSlip(txid){
    if(!confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏ô‡∏µ‡πâ?")) return;
    await fetch(`/delete_slip/${txid}`, {method:"POST"});
    fetchTransactions();
}

async function resetApproved(){
    if(!confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) return;
    await fetch("/reset_approved",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:true})});
    fetchTransactions();
}
async function resetCancelled(){
    if(!confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏£‡∏µ‡πÄ‡∏ã‡∏ó‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) return;
    await fetch("/reset_cancelled",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:true})});
    fetchTransactions();
}

setInterval(fetchTransactions,3000);
fetchTransactions();
</script>
</body>
</html>
